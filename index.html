<!DOCTYPE html>
<html lang="en" data-colors="#ff7a00,#ff2a6d,#7a5cff,#00e5ff" data-edge="circles">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>dbdigital — Contact Card</title>

<!-- Dark on mobile + PWA status bars -->
<meta name="theme-color" content="#0e0f12">
<meta name="color-scheme" content="dark">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Favicons -->
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link rel="icon" href="favicon.ico">
<link rel="apple-touch-icon" href="apple-touch-icon.png">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap" rel="stylesheet">

<style>
  :root{
    color-scheme: dark; /* tell browsers we're dark-native */
    --brand-1:#ff7a00; --brand-2:#ff2a6d; --brand-3:#7a5cff; --brand-4:#00e5ff;
    --brand-gradient: linear-gradient(135deg,var(--brand-1),var(--brand-2),var(--brand-3),var(--brand-4));
    --brand-ring: 0 0 0 2px color-mix(in oklab, var(--brand-3) 55%, transparent);
    --bg-900:#0e0f12; --bg-800:#151926;
    --ink:#e8edf6; --muted:#93a0b5; --line:color-mix(in oklab, white 10%, transparent);
    --radius:30px;
    --shadow-lg:0 28px 72px rgba(0,0,0,.55);
    --glow-soft:0 0 56px color-mix(in oklab, var(--brand-2) 32%, transparent);
    --glow-strong:0 0 96px color-mix(in oklab, var(--brand-3) 38%, transparent);
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  html, body { background-color:#0e0f12 !important; }

  body{
    margin:0;
    font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    color:var(--ink);
    background:
      radial-gradient(1200px 600px at 15% -10%, color-mix(in oklab, var(--brand-4) 8%, transparent), transparent 60%),
      radial-gradient(1000px 500px at 85% 110%, color-mix(in oklab, var(--brand-1) 8%, transparent), transparent 60%),
      var(--bg-900);
    display:grid;
    justify-items:center;
    align-items:start;
    padding:18px;
    overflow:auto;
  }

  .card{
    width:min(460px, 92vw);
    background: linear-gradient(180deg, color-mix(in oklab, white 2%, var(--bg-800)) 0%, var(--bg-800) 70%);
    border-radius:var(--radius);
    box-shadow: var(--shadow-lg), var(--glow-soft);
    border:1px solid var(--line);
    overflow:hidden; position:relative; isolation:isolate;
    -webkit-clip-path: inset(0 round var(--radius));
            clip-path: inset(0 round var(--radius));
    margin:28px 0;
  }

  /* --- Brand header (short; corners visible; tappable) --- */
  .brand-header{
    position:relative; height:110px;
    background: linear-gradient(180deg, rgba(0,0,0,.45), rgba(0,0,0,.15)), var(--brand-gradient);
    border-bottom:1px solid var(--line);
    border-top-left-radius: inherit; border-top-right-radius: inherit;
    overflow:hidden; cursor:pointer;
  }
  /* Two stacked videos for crossfade */
  .brand-header .hero{
    position:absolute; inset:0; width:100%; height:100%;
    object-fit:cover; opacity:0; transition:opacity .6s ease;
    filter:saturate(1.03) contrast(1.04);
  }
  .brand-header .hero.active{ opacity:.26; } /* visible layer */
  .brand-header[data-paused="true"] .hero{ opacity:0 !important; } /* hide when paused */

  .brand-header::after{
    content:""; position:absolute; inset:0; pointer-events:none;
    box-shadow: inset 0 0 110px color-mix(in oklab, var(--brand-3) 22%, transparent);
  }

  /* Circles start 20px from top (clean band at very top) */
  .edge-blend{ position:absolute; left:0; right:0; top:20px; bottom:-1px; pointer-events:none; }
  html[data-edge="circles"] .edge-blend{
    background:
      linear-gradient(to bottom, rgba(0,0,0,0) 0%, rgba(0,0,0,.25) 30%, rgba(0,0,0,.6) 70%, rgba(0,0,0,.9) 100%),
      repeating-radial-gradient(circle at 50% 0%, rgba(255,255,255,.25) 0 2px, rgba(255,255,255,0) 3px 16px);
    mix-blend-mode: overlay; opacity:.24;
    mask-image: linear-gradient(to bottom, black 0%, black 60%, transparent 100%);
  }
  html[data-edge="hex"] .edge-blend{
    --sz:18px;
    background:
      linear-gradient(to bottom, rgba(0,0,0,0) 0%, rgba(0,0,0,.25) 30%, rgba(0,0,0,.6) 70%, rgba(0,0,0,.9) 100%),
      conic-gradient(from 60deg at 50% 0, rgba(255,255,255,.22) 0 60deg, transparent 60deg 120deg, rgba(255,255,255,.22) 120deg 180deg) left/var(--sz) calc(var(--sz)*.577) repeat;
    mix-blend-mode: overlay; opacity:.22;
    mask-image: linear-gradient(to bottom, black 0%, black 60%, transparent 100%);
  }

  /* Top row — right-aligned SVG logo (slightly bigger) */
  .logo-wrap{
    position:absolute; inset:0;
    display:flex; align-items:flex-start; justify-content:flex-end;
    padding:40px 16px 0;
    gap:12px; z-index:2;
  }
  .top-logo{
    height:54px; /* subtle bump */
    aspect-ratio:auto;
    filter: drop-shadow(0 2px 6px rgba(0,0,0,.35));
    display:block;
  }

  /* --- Profile row --- */
  .profile{ display:flex; gap:14px; align-items:center; padding:14px 16px; margin-top:-28px; position:relative; z-index:1; }
  .avatar{
    width:100px; height:100px; border-radius:24px; overflow:hidden; flex:none;
    border:2px solid color-mix(in oklab, var(--brand-4) 55%, transparent);
    box-shadow:0 8px 20px rgba(0,0,0,.45), var(--glow-soft);
    background:linear-gradient(135deg, #1f2330, #10131a); position:relative;
  }
  .avatar::after{ display:none !important; }
  .avatar img{ width:100%; height:100%; object-fit:cover; display:block }
  .who{ display:grid; gap:4px; min-width:0; }
  .who h2{ margin:0; font-size:22px; line-height:1.1; letter-spacing:.01em; color:var(--ink); font-family:'Poppins', system-ui, -apple-system, Segoe UI, Inter, Roboto, Helvetica, Arial, sans-serif; }
  .who .role{ color:var(--muted); font-size:13px }

  /* --- Contact tiles (original feel) --- */
  .contact{ display:grid; gap:12px; padding:4px 20px 6px; }
  .contact a, .contact .item{
    display:flex; gap:12px; align-items:center; text-decoration:none; color:var(--ink);
    padding:16px 16px; border-radius:20px; border:1px solid var(--line);
    background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.005));
    box-shadow: inset 0 -6px 18px rgba(255,255,255,.02);
    transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease, background .2s ease;
    backdrop-filter:saturate(1.2) blur(2px);
  }
  .contact a:hover, .contact .item:hover{
    transform: translateY(-2px);
    border-color: color-mix(in oklab, var(--brand-2) 45%, white 0%);
    box-shadow: var(--glow-soft);
    background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.01));
  }
  .icn{ width:34px; height:34px; display:grid; place-items:center; flex:none; border-radius:12px; background: color-mix(in oklab, var(--brand-3) 16%, transparent); box-shadow: inset var(--brand-ring); }
  .icn svg{ width:18px; height:18px; stroke: currentColor; fill: none; stroke-width:2; opacity:.9 }
  .txt{ display:grid; gap:2px; min-width:0 }
  .label{ font-size:12px; letter-spacing:.08em; text-transform:uppercase; color:var(--muted) }
  .value{ font-size:15px; color:var(--ink); white-space:nowrap; overflow:hidden; text-overflow:ellipsis }

  /* --- CTA + Note --- */
  .cta{ display:grid; gap:12px; padding:8px 20px 20px; }
  .btn{
    display:inline-flex; align-items:center; justify-content:center; gap:10px;
    padding:14px 16px; border-radius:18px; font-weight:700; letter-spacing:.04em; font-size:14px;
    border:1px solid transparent; cursor:pointer; user-select:none;
    background:var(--brand-gradient); color:#0e0f12; box-shadow: var(--glow-strong);
    transition: transform .15s ease, filter .2s ease, box-shadow .2s ease;
  }
  .btn.secondary{ background:transparent; color:var(--ink); border-color: color-mix(in oklab, var(--brand-3) 50%, transparent); box-shadow:none }
  .btn:hover{ transform: translateY(-2px); filter:saturate(1.05) }

  /* --- Footer --- */
  a.foot{ text-decoration:none; border-top:1px solid var(--line); padding:16px 20px 22px; display:flex; gap:10px; align-items:center; justify-content:center; color:var(--muted); font-size:13px; flex-wrap:wrap; transition: background .2s ease, transform .15s ease }
  a.foot:hover{ background:rgba(255,255,255,.03); transform: translateY(-1px) }
  .foot b{ background:var(--brand-gradient); -webkit-background-clip:text; background-clip:text; color:transparent; }
  .pulsr-logo{ height:18px; vertical-align:middle; filter: drop-shadow(0 1px 3px rgba(0,0,0,.25)); }

  @media (max-width:420px){
    .brand-header{height:102px}
    .avatar{width:92px; height:92px; border-radius:22px}
  }
</style>
</head>
<body>
  <main class="card">
    <header class="brand-header" id="brandHeader" role="button" aria-label="Toggle header video">
      <!-- Cross-fade stack -->
      <video class="hero v0" muted playsinline preload="auto"></video>
      <video class="hero v1" muted playsinline preload="auto"></video>

      <div class="logo-wrap">
        <img class="top-logo" src="dbdigitalmarketinglogo.svg" alt="dbdigital logo" />
      </div>

      <div class="edge-blend" aria-hidden="true"></div>
    </header>

    <section class="profile">
      <div class="avatar">
        <img src="dbdigital-profile.jpg" alt="Profile" />
      </div>
      <div class="who">
        <h2>David Bogdanov</h2>
        <div class="role">Founder • dbdigital</div>
      </div>
    </section>

    <nav class="contact">
      <a href="tel:+15648883736" class="item">
        <span class="icn" aria-hidden="true">
          <svg viewBox="0 0 24 24"><path d="M22 16.92v2a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.79 19.79 0 0 1 2.08 4.18 2 2 0 0 1 4.06 2h2a2 2 0 0 1 2 1.72c.12.9.33 1.77.62 2.6a2 2 0 0 1-.45 2.11L7.09 9.91a16 16 0 0 0 6 6l1.48-1.14a2 2 0 0 1 2.11-.45c.83.29 1.7.5 2.6.62A2 2 0 0 1 22 16.92z"/></svg>
        </span>
        <span class="txt"><span class="label">Call</span><span class="value">+1 (564) 888-3736</span></span>
      </a>

      <a href="mailto:david@dbdigitalco.com" class="item">
        <span class="icn" aria-hidden="true">
          <svg viewBox="0 0 24 24"><path d="M4 6h16a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2zm0 0l8 6 8-6"/></svg>
        </span>
        <span class="txt"><span class="label">Email</span><span class="value">david@dbdigitalco.com</span></span>
      </a>

      <a href="mailto:me@davidbogdanov.com" class="item">
        <span class="icn" aria-hidden="true">
          <svg viewBox="0 0 24 24"><path d="M4 6h16a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2zm0 0l8 6 8-6"/></svg>
        </span>
        <span class="txt"><span class="label">Alt Email</span><span class="value">me@davidbogdanov.com</span></span>
      </a>

      <a href="https://dbdigitalco.com" target="_blank" rel="noopener" class="item">
        <span class="icn" aria-hidden="true">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M2 12h20M12 2a15.3 15.3 0 0 1 0 20M12 2a15.3 15.3 0 0 0 0 20"/></svg>
        </span>
        <span class="txt"><span class="label">Website</span><span class="value">dbdigitalco.com</span></span>
      </a>

      <div class="item" tabindex="0">
        <span class="icn" aria-hidden="true">
          <svg viewBox="0 0 24 24"><path d="M21 10c0 6-9 12-9 12S3 16 3 10a9 9 0 1 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
        </span>
        <span class="txt"><span class="label">HQ</span><span class="value">Vancouver, WA • USA</span></span>
      </div>
    </nav>

    <div class="cta">
      <button class="btn" id="saveVcard">Save to Contacts</button>
      <button class="btn secondary" id="openNote">Add Note</button>
    </div>

    <a class="foot" href="https://getpulsr.com" target="_blank" rel="noopener" aria-label="Open getpulsr.com">
      <img class="pulsr-logo" src="pulsr-logo.svg" alt="Pulsr" onerror="this.hidden=true" />
      <span>Made by</span><b>Pulsr</b><span> • getpulsr.com</span>
    </a>
  </main>

  <!-- Add Note Modal -->
  <div class="modal-overlay" id="noteModal" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="note-modal">
      <div class="modal-header">
        <h3 class="modal-title" id="noteTitle">Add Note</h3>
        <button class="close-modal" id="closeNote" aria-label="Close">&times;</button>
      </div>
      <textarea class="note-textarea" placeholder="Type your note here…"></textarea>
      <div class="modal-actions">
        <button class="btn secondary" id="cancelNote">Cancel</button>
        <button class="btn" id="saveNote">Save Note</button>
      </div>
    </div>
  </div>

<script>
  /* Apply <html data-colors> to CSS vars */
  (function(){
    const data = document.documentElement.getAttribute('data-colors');
    if(!data) return; const cols = data.split(',').map(s=>s.trim());
    const rs = document.documentElement;
    cols[0] && rs.style.setProperty('--brand-1', cols[0]);
    cols[1] && rs.style.setProperty('--brand-2', cols[1]);
    cols[2] && rs.style.setProperty('--brand-3', cols[2]);
    cols[3] && rs.style.setProperty('--brand-4', cols[3]);
  })();

  /* Cross-fade rotating header videos + tap-to-toggle */
  (function(){
    const header = document.getElementById('brandHeader');
    const vA = header.querySelector('.hero.v0');
    const vB = header.querySelector('.hero.v1');
    const pool = ['dbdigital.mp4','atoz.mp4','pipesmith.mp4','primos.mp4','rivercrest.mp4','tnc.mp4'];

    let cur = 0;
    let topIsA = true;   // which element is currently showing
    let paused = false;

    function activeEl(){ return topIsA ? vA : vB; }
    function backEl(){ return topIsA ? vB : vA; }

    async function playIndex(i){
      if (!pool.length) return;
      const el = backEl();
      el.src = pool[i];
      try { await el.play(); } catch { /* Autoplay may need a tap first */ }
      // Cross-fade
      el.classList.add('active');
      activeEl().classList.remove('active');
      topIsA = !topIsA;
      activeEl().onended = next;
    }

    function next(){
      if (paused || !pool.length) return;
      cur = (cur + 1) % pool.length;
      playIndex(cur);
    }

    function start(){
      if (!pool.length) return;
      header.removeAttribute('data-paused');
      paused = false;
      cur = Math.floor(Math.random() * pool.length);
      playIndex(cur);
    }

    function stop(){
      paused = true;
      header.setAttribute('data-paused','true');
      [vA, vB].forEach(v => { try{ v.pause(); }catch{} });
    }

    // Start immediately; if autoplay is blocked, first tap will start it
    start();

    // Tap anywhere on header to toggle
    header.addEventListener('click', ()=>{ paused ? start() : stop(); });
  })();

  /* Modal logic */
  (function(){
    const modal = document.getElementById('noteModal');
    const open = document.getElementById('openNote');
    const closeBtn = document.getElementById('closeNote');
    const cancel = document.getElementById('cancelNote');
    const save = document.getElementById('saveNote');
    const textarea = modal.querySelector('textarea');
    let userNote = '';

    function show(){ modal.style.display='flex'; textarea.value = userNote; textarea.focus(); }
    function hide(){ modal.style.display='none'; }

    open.addEventListener('click', show);
    closeBtn.addEventListener('click', hide);
    cancel.addEventListener('click', hide);
    modal.addEventListener('click', (e)=>{ if(e.target===modal) hide(); });

    save.addEventListener('click', ()=>{ userNote = textarea.value; hide(); });

    window.__getUserNote = ()=>userNote;
  })();

  /* vCard NOTE escaping */
  function escapeNote(text){
    if(!text) return '';
    let t = String(text).replace(/\r\n/g, '\n').replace(/\r/g, '\n');
    t = t.replace(/\\n/g, '\u0000');
    t = t.replace(/\n/g, '\\n');
    t = t.replace(/\u0000/g, '\\n');
    return `NOTE:${t}\n`;
  }

  /* vCard download with embedded photo */
  (function(){
    const btn = document.getElementById('saveVcard');
    btn.addEventListener('click', async () => {
      btn.disabled = true; const original = btn.textContent; btn.textContent = 'Preparing…';
      try{
        const imgResp = await fetch('dbdigital-profile.jpg');
        const blob = await (imgResp.ok ? imgResp.blob() : Promise.resolve(new Blob()));
        const b64 = await new Promise((res)=>{
          if(blob.size===0) return res('');
          const r=new FileReader(); r.onload=()=>res(String(r.result).split(',')[1]||''); r.readAsDataURL(blob);
        });

        const rawNote = (window.__getUserNote && window.__getUserNote()) ? window.__getUserNote() : '';
        const noteLine = escapeNote(rawNote);

        const vcf = `BEGIN:VCARD\nVERSION:3.0\nN:Bogdanov;David;;;\nFN:David Bogdanov\n${noteLine}TEL;TYPE=WORK,VOICE:+15648883736\nEMAIL;TYPE=WORK:david@dbdigitalco.com\nEMAIL;TYPE=HOME:me@davidbogdanov.com\nORG:dbdigital\nTITLE:Founder\nADR;TYPE=WORK:;;;Vancouver;WA;;USA\nURL;TYPE=WORK:https://dbdigitalco.com\nPHOTO;ENCODING=b;TYPE=JPEG:${b64}\nEND:VCARD`;

        const url = URL.createObjectURL(new Blob([vcf],{type:'text/vcard;charset=utf-8'}));
        const a = Object.assign(document.createElement('a'),{href:url,download:'David_Bogdanov_dbdigital.vcf'});
        document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
        btn.textContent = 'Saved!';
        setTimeout(()=>{btn.textContent=original; btn.disabled=false;},1300);
      }catch(err){
        console.error(err);
        btn.textContent = 'Try again';
        setTimeout(()=>{btn.textContent=original; btn.disabled=false;},1300);
      }
    });
  })();
</script>
</body>
</html>
